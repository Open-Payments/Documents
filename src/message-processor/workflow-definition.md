# Workflow Definition Format Specification

The Workflow Definition format specifies the structure and sequence of steps required to process a message. Each workflow contains a unique identifier, a version, and a list of sequential steps, where each step has specific actions such as enrichment, validation, transformation, or outbound dispatch. Below is the generic format specification for defining a workflow in JSON.

---

### Workflow Structure

```json
{
    "id": "string",                 // Unique identifier for the workflow.
    "name": "string",               // Descriptive name of the workflow.
    "description": "string",        // Detailed description of what the workflow accomplishes.
    "version": integer,             // Version number of the workflow definition.
    "steps": [                      // List of steps in the workflow.
        {
            "step_id": "string",                   // Unique identifier for the step within the workflow.
            "name": "string",                      // Name of the step.
            "description": "string",               // Description of the step's purpose.
            "type": "string",                      // Type of step (e.g., "enrichment", "validation", "transformation", "outbound").
            
            // For enrichment steps:
            "service": "string",                   // Name of the external service or system used for enrichment.
            "input": {                             // Input fields required by the service.
                "message_field": ["string"]        // List of fields from the message needed for enrichment.
            },
            "output": {                            // Output fields generated by the service.
                "enriched_fields": ["string"]      // List of fields enriched by the service.
            },
            
            // For validation steps:
            "rules": [                             // List of validation rules applied to the message.
                {
                    "rule_id": "string",           // Unique identifier for the rule.
                    "field": "string",             // Message field to validate.
                    "condition": "string",         // Validation condition (e.g., "not_null", "equals").
                    "value": "string (optional)",  // Expected value for conditions like "equals".
                    "error_message": "string"      // Error message to return if validation fails.
                }
            ],

            // For transformation steps:
            "input_format": "string",              // Format of the message before transformation.
            "output_format": "string",             // Desired format of the message after transformation.
            "output_type": "string",               // Specific type/version of the output format.

            // For outbound dispatch steps:
            "connection": "string",                // Name of the outbound connection.
            "retry_policy": {                      // Configuration for retrying failed dispatch attempts.
                "max_retries": integer,            // Maximum number of retry attempts.
                "retry_interval": "string"         // Interval between retries (e.g., "30s").
            }
        }
    ]
}